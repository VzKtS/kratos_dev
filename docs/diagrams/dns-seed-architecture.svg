<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1000 700">
  <defs>
    <linearGradient id="dnsSeedGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#9333EA;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#7C3AED;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="nodeGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#4F46E5;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#3730A3;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="storageGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#059669;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#047857;stop-opacity:1" />
    </linearGradient>
    <linearGradient id="apiGrad" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#F59E0B;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#D97706;stop-opacity:1" />
    </linearGradient>
    <filter id="shadow" x="-20%" y="-20%" width="140%" height="140%">
      <feDropShadow dx="2" dy="4" stdDeviation="3" flood-opacity="0.3"/>
    </filter>
    <marker id="arrowhead" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#94A3B8"/>
    </marker>
    <marker id="arrowGreen" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#10B981"/>
    </marker>
    <marker id="arrowPurple" markerWidth="10" markerHeight="7" refX="9" refY="3.5" orient="auto">
      <polygon points="0 0, 10 3.5, 0 7" fill="#A78BFA"/>
    </marker>
  </defs>

  <!-- Background -->
  <rect width="1000" height="700" fill="#0F172A"/>

  <!-- Title -->
  <text x="500" y="35" text-anchor="middle" fill="#F8FAFC" font-family="Arial, sans-serif" font-size="24" font-weight="bold">DNS Seed Service Architecture</text>
  <text x="500" y="55" text-anchor="middle" fill="#94A3B8" font-family="Arial" font-size="12">kratos-dns-seed - Peer Discovery &amp; Network State</text>

  <!-- DNS Seed Box (main container) -->
  <rect x="280" y="75" width="440" height="520" rx="15" fill="none" stroke="#9333EA" stroke-width="2" stroke-dasharray="5,5"/>
  <text x="500" y="100" text-anchor="middle" fill="#C4B5FD" font-family="Arial" font-size="12">kratos-dns-seed</text>

  <!-- KratOs Nodes (left side) -->
  <g filter="url(#shadow)">
    <rect x="30" y="140" width="180" height="100" rx="10" fill="url(#nodeGrad)"/>
    <text x="120" y="170" text-anchor="middle" fill="white" font-family="Arial" font-size="14" font-weight="bold">KratOs Node 1</text>
    <text x="120" y="190" text-anchor="middle" fill="white" font-family="Arial" font-size="10">Validator</text>
    <text x="120" y="210" text-anchor="middle" fill="#A5B4FC" font-family="Arial" font-size="9">12D3KooWSpA...</text>
    <text x="120" y="225" text-anchor="middle" fill="#A5B4FC" font-family="Arial" font-size="9">45.8.132.252:30333</text>
  </g>

  <g filter="url(#shadow)">
    <rect x="30" y="270" width="180" height="100" rx="10" fill="url(#nodeGrad)"/>
    <text x="120" y="300" text-anchor="middle" fill="white" font-family="Arial" font-size="14" font-weight="bold">KratOs Node 2</text>
    <text x="120" y="320" text-anchor="middle" fill="white" font-family="Arial" font-size="10">Full Node</text>
    <text x="120" y="340" text-anchor="middle" fill="#A5B4FC" font-family="Arial" font-size="9">12D3KooWEeX...</text>
    <text x="120" y="355" text-anchor="middle" fill="#A5B4FC" font-family="Arial" font-size="9">5.189.184.205:30333</text>
  </g>

  <g filter="url(#shadow)">
    <rect x="30" y="400" width="180" height="100" rx="10" fill="url(#nodeGrad)"/>
    <text x="120" y="430" text-anchor="middle" fill="white" font-family="Arial" font-size="14" font-weight="bold">KratOs Node N</text>
    <text x="120" y="450" text-anchor="middle" fill="white" font-family="Arial" font-size="10">Validator</text>
    <text x="120" y="470" text-anchor="middle" fill="#A5B4FC" font-family="Arial" font-size="9">12D3KooWxYz...</text>
    <text x="120" y="485" text-anchor="middle" fill="#A5B4FC" font-family="Arial" font-size="9">74.208.14.99:30333</text>
  </g>

  <!-- Heartbeat Receiver -->
  <g filter="url(#shadow)">
    <rect x="300" y="120" width="180" height="100" rx="8" fill="url(#dnsSeedGrad)"/>
    <text x="390" y="150" text-anchor="middle" fill="white" font-family="Arial" font-size="13" font-weight="bold">Heartbeat Receiver</text>
    <text x="390" y="170" text-anchor="middle" fill="white" font-family="Arial" font-size="10">heartbeat/mod.rs</text>
    <text x="390" y="190" text-anchor="middle" fill="#E9D5FF" font-family="Arial" font-size="10">TCP :30334</text>
    <text x="390" y="205" text-anchor="middle" fill="#E9D5FF" font-family="Arial" font-size="9">Ed25519 Verification</text>
  </g>

  <!-- Network State Aggregator -->
  <g filter="url(#shadow)">
    <rect x="520" y="120" width="180" height="100" rx="8" fill="url(#dnsSeedGrad)"/>
    <text x="610" y="150" text-anchor="middle" fill="white" font-family="Arial" font-size="13" font-weight="bold">NetworkState</text>
    <text x="610" y="170" text-anchor="middle" fill="white" font-family="Arial" font-size="10">network_state.rs</text>
    <text x="610" y="190" text-anchor="middle" fill="#E9D5FF" font-family="Arial" font-size="10">Security State</text>
    <text x="610" y="205" text-anchor="middle" fill="#E9D5FF" font-family="Arial" font-size="9">Validator Count</text>
  </g>

  <!-- Peer Registry -->
  <g filter="url(#shadow)">
    <rect x="340" y="260" width="320" height="110" rx="10" fill="url(#storageGrad)"/>
    <text x="500" y="295" text-anchor="middle" fill="white" font-family="Arial" font-size="14" font-weight="bold">Peer Registry</text>
    <text x="500" y="315" text-anchor="middle" fill="white" font-family="Arial" font-size="11">registry/storage.rs | scoring.rs</text>
    <text x="500" y="335" text-anchor="middle" fill="#A7F3D0" font-family="Arial" font-size="10">RocksDB | Peer Scores (0-200)</text>
    <text x="500" y="355" text-anchor="middle" fill="#A7F3D0" font-family="Arial" font-size="9">peer_id | libp2p_peer_id | addresses | last_seen</text>
  </g>

  <!-- DNS Server -->
  <g filter="url(#shadow)">
    <rect x="300" y="410" width="140" height="90" rx="8" fill="url(#apiGrad)"/>
    <text x="370" y="440" text-anchor="middle" fill="white" font-family="Arial" font-size="13" font-weight="bold">DNS Server</text>
    <text x="370" y="460" text-anchor="middle" fill="white" font-family="Arial" font-size="10">dns/handler.rs</text>
    <text x="370" y="480" text-anchor="middle" fill="#FEF3C7" font-family="Arial" font-size="10">UDP :53</text>
    <text x="370" y="495" text-anchor="middle" fill="#FEF3C7" font-family="Arial" font-size="9">A/TXT/SRV</text>
  </g>

  <!-- HTTP API -->
  <g filter="url(#shadow)">
    <rect x="460" y="410" width="140" height="90" rx="8" fill="url(#apiGrad)"/>
    <text x="530" y="440" text-anchor="middle" fill="white" font-family="Arial" font-size="13" font-weight="bold">HTTP API</text>
    <text x="530" y="460" text-anchor="middle" fill="white" font-family="Arial" font-size="10">api/mod.rs</text>
    <text x="530" y="480" text-anchor="middle" fill="#FEF3C7" font-family="Arial" font-size="10">HTTP :8080</text>
    <text x="530" y="495" text-anchor="middle" fill="#FEF3C7" font-family="Arial" font-size="9">/peers /health</text>
  </g>

  <!-- IDpeers Generator -->
  <g filter="url(#shadow)">
    <rect x="340" y="530" width="320" height="55" rx="8" fill="url(#dnsSeedGrad)"/>
    <text x="500" y="555" text-anchor="middle" fill="white" font-family="Arial" font-size="12" font-weight="bold">IDpeers.json Generator</text>
    <text x="500" y="575" text-anchor="middle" fill="#E9D5FF" font-family="Arial" font-size="10">distribution/generator.rs | Signed peer lists</text>
  </g>

  <!-- New Node (right side) -->
  <g filter="url(#shadow)">
    <rect x="780" y="280" width="190" height="140" rx="10" fill="url(#nodeGrad)"/>
    <text x="875" y="310" text-anchor="middle" fill="white" font-family="Arial" font-size="14" font-weight="bold">New Node</text>
    <text x="875" y="330" text-anchor="middle" fill="white" font-family="Arial" font-size="10">Joining Network</text>
    <line x1="800" y1="345" x2="950" y2="345" stroke="rgba(255,255,255,0.3)"/>
    <text x="875" y="365" text-anchor="middle" fill="#A5B4FC" font-family="Arial" font-size="9">1. Fetch /peers</text>
    <text x="875" y="385" text-anchor="middle" fill="#A5B4FC" font-family="Arial" font-size="9">2. Verify signature</text>
    <text x="875" y="405" text-anchor="middle" fill="#A5B4FC" font-family="Arial" font-size="9">3. Connect via libp2p_peer_id</text>
  </g>

  <!-- Heartbeat Arrows (nodes to receiver) -->
  <path d="M 210 180 L 300 165" stroke="#A78BFA" stroke-width="2" marker-end="url(#arrowPurple)"/>
  <path d="M 210 310 L 300 190" stroke="#A78BFA" stroke-width="2" marker-end="url(#arrowPurple)"/>
  <path d="M 210 440 L 300 200" stroke="#A78BFA" stroke-width="2" marker-end="url(#arrowPurple)"/>

  <!-- Labels for heartbeats -->
  <text x="240" y="150" fill="#A78BFA" font-family="Arial" font-size="9">Heartbeat</text>
  <text x="240" y="160" fill="#A78BFA" font-family="Arial" font-size="8">(every 2min)</text>

  <!-- Internal arrows -->
  <path d="M 390 220 L 430 260" stroke="#94A3B8" stroke-width="2"/>
  <path d="M 610 220 L 570 260" stroke="#94A3B8" stroke-width="2"/>
  <path d="M 370 370 L 370 410" stroke="#94A3B8" stroke-width="2"/>
  <path d="M 500 370 L 500 410" stroke="#94A3B8" stroke-width="2"/>
  <path d="M 530 500 L 530 530" stroke="#94A3B8" stroke-width="2"/>
  <path d="M 370 500 L 420 530" stroke="#94A3B8" stroke-width="2"/>

  <!-- API response arrow -->
  <path d="M 600 450 L 780 360" stroke="#10B981" stroke-width="2" marker-end="url(#arrowGreen)"/>
  <text x="700" y="390" fill="#10B981" font-family="Arial" font-size="9">IDpeers.json</text>

  <!-- HeartbeatMessage Structure -->
  <g filter="url(#shadow)">
    <rect x="30" y="530" width="220" height="150" rx="8" fill="#1E293B"/>
    <text x="140" y="555" text-anchor="middle" fill="#F8FAFC" font-family="Arial" font-size="11" font-weight="bold">HeartbeatMessage</text>
    <line x1="45" y1="565" x2="235" y2="565" stroke="#374151"/>
    <text x="50" y="585" fill="#A5B4FC" font-family="monospace" font-size="9">peer_id: [u8; 32]</text>
    <text x="50" y="600" fill="#6B7280" font-family="Arial" font-size="8">(Ed25519 for signature)</text>
    <text x="50" y="620" fill="#A5B4FC" font-family="monospace" font-size="9">libp2p_peer_id: String</text>
    <text x="50" y="635" fill="#6B7280" font-family="Arial" font-size="8">(Base58 for connection)</text>
    <text x="50" y="655" fill="#A5B4FC" font-family="monospace" font-size="9">addresses: Vec&lt;String&gt;</text>
    <text x="50" y="670" fill="#6B7280" font-family="Arial" font-size="8">(Multiaddr list)</text>
  </g>

  <!-- Legend -->
  <rect x="780" y="500" width="200" height="110" rx="8" fill="#1E293B"/>
  <text x="880" y="525" text-anchor="middle" fill="#F8FAFC" font-family="Arial" font-size="12" font-weight="bold">Legend</text>
  <rect x="795" y="540" width="20" height="12" rx="2" fill="url(#dnsSeedGrad)"/>
  <text x="825" y="550" fill="#94A3B8" font-family="Arial" font-size="10">DNS Seed Service</text>
  <rect x="795" y="560" width="20" height="12" rx="2" fill="url(#nodeGrad)"/>
  <text x="825" y="570" fill="#94A3B8" font-family="Arial" font-size="10">KratOs Node</text>
  <rect x="795" y="580" width="20" height="12" rx="2" fill="url(#storageGrad)"/>
  <text x="825" y="590" fill="#94A3B8" font-family="Arial" font-size="10">Storage</text>
  <rect x="795" y="600" width="20" height="12" rx="2" fill="url(#apiGrad)"/>
  <text x="825" y="610" fill="#94A3B8" font-family="Arial" font-size="10">Public API</text>

  <!-- Ports summary -->
  <text x="880" y="640" text-anchor="middle" fill="#6B7280" font-family="Arial" font-size="9">Ports: TCP 30334 | UDP 53 | HTTP 8080</text>
</svg>
